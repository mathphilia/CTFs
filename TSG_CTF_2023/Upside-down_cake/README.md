# Upside-down cake
category: Web  
100 points, 127 solves

## 問題
> 設定が正しいか、413回チェックしました。  
> [http://34.84.176.251:12349](http://34.84.176.251:12349)  
> 初心者向けヒント  
> - とりあえず、上のリンクを開いて、適当に操作してみてください。この問題は「非常に長い回文」をサーバーに送ることでフラグが手に入ると主張していますが、話はそんなに単純ではないことがすぐに分かります。  
> - 次に、添付したソースコードを読んでください。`main.mjs` や `nginx.conf` といったファイルにこのウェブサイトの重要なロジックが記述されています。`flag` という変数にフラグが保存されているので、この値をリークすることが目的となります。  
> - これらのヒントを元に、「非常に長い回文」をサーバーに送るのではなく、何かしらのバグを突くことによってフラグを手に入れる方法を考えましょう。Web技術、特にJavaScriptについての知識が必要になるかもしれないので、必要に応じてMDNなどのドキュメントを参照してください。  
> - なお、この問題を解くのに大量のアクセスをする必要はありません。ルールに書かれている通り、DoS まがいの大量アクセスはご遠慮ください。  

## 解法
`string.length`が1000より小さいとリジェクトされるが100文字以上のリクエストは弾かれる。ということは`string` (HTML上では`palindrome`)を文字列でないオブジェクトにすればいいのでは？と考えられる。HTML中の`JSON.stringify({palindrome})`は`{"palindrome":...}`という形のJSONを返すので、これと同様の形式の文字列を送信すればよい。lengthが大きいと面倒なので、lengthは`'a'`にしておく。こうするとあとは回文判定をパスするように考えると`{0: 'a', length: 'a', NaN: 'a'}`が条件を満たすと分かる。
