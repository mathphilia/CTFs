# Streamer
category: Crypto  
125 points, 60 solves

## 問題
> これは私のシンプルなストリーム暗号です。突破できますか？

## 解法
MD5ハッシュをBase64エンコードされたものが埋め込まれたflagが平文で16bytesの乱数を鍵とするVigenère暗号。鍵を特定することが目標となる。平文は`TSGCTF{...}`という形式であり全体の桁数は304(=16×19)桁なので、鍵の0～6桁目および15桁目は特定できる。また、MD5ハッシュは128bitなのでこれをBase64エンコードすると末尾は`==`になる。これで鍵の13,14桁目が分かる。更に、同様の理由から`==`の直前の桁は`AQgw`の4択である。次に、平文の各文字は特定の正規表現(Markdownでバッククォートをうまくエスケープできなかったので具体的な内容はここにかけない)にマッチする形式である。したがって $k=7,8,\dots,12$ の各々について、鍵の $k$ 桁目は平文の $16n+k$ 桁目がその正規表現にマッチするように選ぶことになる。論理で詰められるのはここまでなので、残りは文脈を手掛かりに特定する。leetがきつめなので割と気合いが必要。
