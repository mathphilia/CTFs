<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], displayMath: [['$$', '$$']]}
    });
</script>

# powerRSA
category: Crypto
225.56 points, 31 solves

## 問題
> ヤーーッ！パワーーッ！(ﾆｯ
> 
> ソースコード
> ```py
> from Crypto.Util.number import getPrime, bytes_to_long
> from secret import FLAG
> 
> m = bytes_to_long(FLAG)
> p = getPrime(512)
> q = getPrime(512)
> N = p * q
> e = 0x10001
> r = pow(p, q, N)
> c = pow(m, e, N)
> 
> print("N:", N)
> print("r:", r)
> print("c:", c)
> ```
> 暗号
> ```
> N: 90155872626109118751539082340637664291284739918666752584753399796834394108934269799361082409068780300733478243187803947914852201275756546305701601038245062017076328987708208192044674964106835923338854908195583033310310682803512196201848036103484667516142174036453910627093541752413321035733931243762833992113
> r: 9322793222533738919136767770062343847990445869750540466031127454552421896606703877767352447027469817530156341564290950012563071681611937229761941420331277
> c: 6146682863326523930660780475800345684609346868118904988599020801137516078990162263453764612248242206809400248946028976662634601168167123937919798903932765746347318386910880849642655181553179504240263695508893635468417428856823495012423849224891599994895553098814398443037416874773801965115317240666818199846
> ```

## 解法
$r=p^q\%N$は$p$の倍数である$p^q$から$p$の倍数である$N$の倍数を引いたものなので、$r$も$p$の倍数である。よって、`math.gcd`等を用いて$\gcd(r,n)$を計算すれば$p$が求まる。あとは$pq=N$から$q$を求めてRSA_warmupと同様に復号するだけ。
