# rps-casino
category: Crypto  
131 points, 94 solves

## 問題
> We're opening a new casino! The only game is rock-paper-scissors though...  
> `nc mc.ax 31234`

## 解法
LFSRの問題。内部状態が64bit, 出力長が4bitのLFSRを使ってじゃんけんの手が選ばれる。56回分の出す手を教えられ、その後50回連続でじゃんけんに勝つとflagを貰える。今回のLFSRの仕様上、 $i$ 回目および $(i+1)$ 回目の出力が分かれば $(i+16)$ 回目の出力が確定する。さて、出された手が`rock`ならLFSRの出力は0,3,6,9,12,15のいずれか、`paper`なら1,4,7,10,13のいずれか、`scissors`なら2,5,8,11,14のいずれかであると分かる。したがって、例えば最初の2回分の手からLFSRの最初の2回の出力が何であったかには候補が25個~36個生まれることになる。この各パターンに対して16回目(最初の出力を0回目とする)の出力を計算し、それが16回目の出力の候補に含まれるか見ることにより最初の2回の出力の候補を絞ることができる。同様の手順で最初の $n$ 回の出力の候補を絞り続ける。最初の16回の出力はLFSRの初期の内部状態を示しているので、最初の16回の出力の各候補に対してそれが全56回のじゃんけんの手に適合するか判定すると、LFSRの初期の内部状態を知ることができる。あとはそれに続く50回のじゃんけんの手を計算すればよい。
