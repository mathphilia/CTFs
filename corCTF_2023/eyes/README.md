# eyes
category: Crypto  
140 points, 75 solves

## 問題
> can you see it?

## 解法
`fn`は列ヴェクトル $x$ を引数にとり、下三角行列 $A$ と列ヴェクトル $B$ を用いて ${}^txAx+{}^tBx+\texttt{flag}\bmod p$ を計算して返す函数である( $A,B$ は固定)。 $A,B$ は $1024$ 次元であるが、このコードにおいて $x$ の第 $4$ 成分以降はすべて $0$ であるため実際に計算に使われるのはごく一部である。  

$$A=\begin{pmatrix}a_{11}&0&0&\dots\\\\a_{21}&a_{22}&0&\dots\\\\a_{31}&a_{32}&a_{33}&\dots\\\\\\vdots&\vdots&\vdots&\ddots\end{pmatrix},B=\begin{pmatrix}b_1\\\\b_2\\\\b_3\\\\\\vdots\end{pmatrix}$$  

とおき、`fn(conv(i + 1))`の出力を $L_i$ とする。このとき  

$$\begin{alignat*}{10}
L_0&=a_{11}&&&&&&&&&&&{}+{}&b_1&&&&&{}+{}&\texttt{flag}\\
L_1&=&&&&a_{22}&&&&&&&&&{}+{}&b_2&&&{}+{}&\texttt{flag}\\
L_2&=a_{11}&{}+{}&a_{21}&{}+{}&a_{22}&&&&&&&{}+{}&b_1&{}+{}&b_2&&&{}+{}&\texttt{flag}\\
L_3&=&&&&&&&&&&a_{33}&&&&&{}+{}&b_3&{}+{}&\texttt{flag}\\
L_4&=a_{11}&&&&&{}+{}&a_{31}&&&{}+{}&a_{33}&{}+{}&b_1&&&{}+{}&b_3&{}+{}&\texttt{flag}\\
L_5&=&&&&a_{22}&&&{}+{}&a_{32}&{}+{}&a_{33}&&&{}+{}&b_2&{}+{}&b_3&{}+{}&\texttt{flag}\\
L_6&=a_{11}&{}+{}&a_{21}&{}+{}&a_{22}&{}+{}&a_{31}&{}+{}&a_{32}&{}+{}&a_{33}&{}+{}&b_1&{}+{}&b_2&{}+{}&b_3&{}+{}&\texttt{flag}
\end{alignat*}$$  

である。少々見づらいのでいい感じに並べ替えると  

$$\begin{alignat*}{10}
L_0&=a_{11}&&&&&&&&&&&{}+{}&b_1&&&&&{}+{}&\texttt{flag}\\
L_1&=&&a_{22}&&&&&&&&&&&{}+{}&b_2&&&{}+{}&\texttt{flag}\\
L_3&=&&&&a_{33}&&&&&&&&&&&{}+{}&b_3&{}+{}&\texttt{flag}\\
L_2&=a_{11}&{}+{}&a_{22}&&&{}+{}&a_{21}&&&&&{}+{}&b_1&{}+{}&b_2&&&{}+{}&\texttt{flag}\\
L_4&=a_{11}&&&{}+{}&a_{33}&&&{}+{}&a_{31}&&&{}+{}&b_1&&&{}+{}&b_3&{}+{}&\texttt{flag}\\
L_5&=&&a_{22}&{}+{}&a_{33}&&&&&{}+{}&a_{32}&&&{}+{}&b_2&{}+{}&b_3&{}+{}&\texttt{flag}\\
L_6&=a_{11}&{}+{}&a_{22}&{}+{}&a_{33}&{}+{}&a_{21}&{}+{}&a_{31}&{}+{}&a_{32}&{}+{}&b_1&{}+{}&b_2&{}+{}&b_3&{}+{}&\texttt{flag}
\end{alignat*}$$  

となる。ここから、 $L_0+L_1+L_3-L_2-L_4-L_5+L_6=\texttt{flag}$ が分かる。
